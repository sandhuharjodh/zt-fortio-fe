(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{2768:(e,t,a)=>{Promise.resolve().then(a.bind(a,2544))},3394:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>c,GV:()=>d,jL:()=>i});var s=a(8943),r=a(1337),l=a(4551),o=a(3391);let n=(0,s.U1)({reducer:{user:r.Ay,userLoginEvent:l.A}}),i=()=>(0,o.wA)(),d=o.d4,c=n},4551:(e,t,a)=>{"use strict";a.d(t,{A:()=>o,s:()=>l});var s=a(8943);let r=async e=>{console.log(e,"vccvvcvcv");let t=await fetch("http://localhost:8000/api/users/fetch-user/".concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error((await t.json()).message||"Login failed");return t.json()},l=(0,s.zD)("auth/userLoginEventsDetail",async(e,t)=>{let{rejectWithValue:a}=t;try{return await r(e)}catch(e){return a(e.message||"Failed to fetch login events.")}}),o=(0,s.Z0)({name:"userLoginEvent",initialState:{userLoginEvent:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(l.pending,e=>{e.loading=!0,e.error=null}).addCase(l.fulfilled,(e,t)=>{e.loading=!1,e.userLoginEvent=t.payload}).addCase(l.rejected,(e,t)=>{e.loading=!1,e.error=t.payload||"Something went wrong."})}}).reducer},1337:(e,t,a)=>{"use strict";a.d(t,{Y4:()=>i,AM:()=>d,Ay:()=>x,ri:()=>h,nt:()=>n});var s=a(8943);let r=async(e,t,a,s)=>{let r=await fetch("http://localhost:8000/api/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,lat:a,long:s})});if(!r.ok)throw Error((await r.json()).message||"Login failed");return r.json()},l=async()=>{let e=await fetch("http://localhost:8000/api/users/user-list",{method:"Get",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error((await e.json()).message||"No User Found");return e.json()},o=async e=>{let t=await fetch("http://localhost:8000/api/users/user/".concat(e),{method:"Get",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error((await t.json()).message||"No User Found");return t.json()},n=(0,s.zD)("auth/userDetail",async()=>await l()),i=(0,s.zD)("auth/login",async e=>{let{email:t,password:a,lat:s,long:l}=e;return await r(t,a,s,l)}),d=(0,s.zD)("auth/userById",async e=>await o(e)),c=(0,s.Z0)({name:"user",initialState:{token:null,userDetails:null,userDetailByID:null,isLoading:!1,error:null},reducers:{logout(e){e.token=null,e.userDetails=null,e.isLoading=!1,e.error=null}},extraReducers:e=>{e.addCase(i.pending,e=>{e.isLoading=!0,e.error=null}).addCase(i.fulfilled,(e,t)=>{e.isLoading=!1,e.token=t.payload.token,e.userDetails={email:t.payload.email,role:t.payload.role,id:t.payload.id}}).addCase(i.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(n.pending,e=>{e.isLoading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.isLoading=!1,e.token=t.payload.token,e.userDetails=t.payload}).addCase(n.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(d.pending,e=>{e.isLoading=!0,e.error=null}).addCase(d.fulfilled,(e,t)=>{e.isLoading=!1,e.token=t.payload.token,e.userDetailByID=t.payload}).addCase(d.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload})}}),{logout:h}=c.actions,x=c.reducer},2544:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var s=a(5155),r=a(2115),l=a(3394),o=a(8735),n=a(767),i=a(3463),d=a(9795);function c(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,d.QP)((0,i.$)(t))}let h=o.bL;o.l9;let x=o.ZL;o.bm;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.hJ,{ref:t,className:c("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});p.displayName=o.hJ.displayName;let g=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(x,{children:[(0,s.jsx)(p,{}),(0,s.jsxs)(o.UC,{ref:t,className:c("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[r,(0,s.jsxs)(o.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(n.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});g.displayName=o.UC.displayName;let m=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:c("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};m.displayName="DialogHeader";let u=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:c("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};u.displayName="DialogFooter";let f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.hE,{ref:t,className:c("text-lg font-semibold leading-none tracking-tight",a),...r})});f.displayName=o.hE.displayName;let y=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.VY,{ref:t,className:c("text-sm text-muted-foreground",a),...r})});y.displayName=o.VY.displayName;var b=a(4551);let j=e=>{var t;let{isOpen:a,onClose:o,userId:n}=e,i=(0,l.GV)(e=>e.userLoginEvent),d=(0,l.jL)();(0,r.useEffect)(()=>{d((0,b.s)(n))},[n]);let c=(null==i?void 0:null===(t=i.userLoginEvent)||void 0===t?void 0:t.userlisting)||[];return(0,s.jsx)(h,{open:a,onOpenChange:o,children:(0,s.jsxs)(g,{className:"max-w-3xl overflow-hidden gap-0",style:{minWidth:"85%"},children:[(0,s.jsxs)(m,{children:[(0,s.jsx)(f,{className:"text-lg ps-2 py-1 font-semibold text-gray-800 w-100 assign-text",children:"Login Events"}),(0,s.jsx)(y,{className:"text-sm text-gray-600 ps-2",children:"Recent login activity details are listed below."})]}),(0,s.jsx)("div",{className:"mt-4 w-100 overflow-auto scroll-container",children:c.length>0?(0,s.jsx)("div",{className:"max-h-96 overflow-auto scroll-container border rounded-lg shadow-sm",children:(0,s.jsxs)("table",{className:"w-full text-sm border-collapse border border-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-100 text-gray-700",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2   bg-[#5FA7F5] text-white font-bold risk",children:"Device"}),(0,s.jsx)("th",{className:"px-4 py-2   bg-[#5FA7F5] text-white font-bold risk",children:"Location"}),(0,s.jsx)("th",{className:"px-4 py-2   bg-[#5FA7F5] text-white font-bold risk",children:"Date & Time"}),(0,s.jsx)("th",{className:"px-4 py-2   bg-[#5FA7F5] text-white font-bold risk",children:"Location Tracking"}),(0,s.jsx)("th",{className:"px-4 py-2   bg-[#5FA7F5] text-white font-bold risk",children:"Device Tracking"}),(0,s.jsx)("th",{className:"px-4 py-2   bg-[#5FA7F5] text-white font-bold risk",children:"False Login Attempt"}),(0,s.jsx)("th",{className:"px-4 py-2   bg-[#5FA7F5] text-white font-bold risk",children:"Login Time Analysis"}),(0,s.jsx)("th",{className:"px-4 py-2   bg-[#5FA7F5] text-white font-bold risk",children:"IP Repetition"}),(0,s.jsx)("th",{className:"px-4 py-2   bg-[#5FA7F5] text-white font-bold rounded-tr-lg risk",children:"Average %"})]})}),(0,s.jsx)("tbody",{children:c.map(e=>{var t,a,r,l,o;return(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsxs)("td",{className:"px-4 py-2 border name-h-color",children:[null===(t=e.deviceDetails)||void 0===t?void 0:t.deviceType," -"," ",null===(a=e.deviceDetails)||void 0===a?void 0:a.browser," -"," ",null===(r=e.deviceDetails)||void 0===r?void 0:r.os]}),(0,s.jsxs)("td",{className:"px-4 py-2 border name-h-color",children:[null===(l=e.location)||void 0===l?void 0:l.city,", ",null===(o=e.location)||void 0===o?void 0:o.country]}),(0,s.jsx)("td",{className:"px-4 py-2 border name-h-color",children:e.createdAt?new Date(e.createdAt).toLocaleString():"N/A"}),(0,s.jsx)("td",{className:"px-4 py-2 border name-h-color",children:isNaN(e.locationTrackingMiddleware)?0:Math.round(100*e.locationTrackingMiddleware)/100}),(0,s.jsx)("td",{className:"px-4 py-2 border name-h-color",children:isNaN(e.deviceTrackingMiddleware)?0:Math.round(100*e.deviceTrackingMiddleware)/100}),(0,s.jsx)("td",{className:"px-4 py-2 border name-h-color",children:isNaN(e.falseLoginAttemptMiddleware)?0:Math.round(100*e.falseLoginAttemptMiddleware)/100}),(0,s.jsx)("td",{className:"px-4 py-2 border name-h-color",children:isNaN(e.loginTimeAnalysisMiddleware)?0:Math.round(100*e.loginTimeAnalysisMiddleware)/100}),(0,s.jsx)("td",{className:"px-4 py-2 border name-h-color",children:isNaN(e.ipRepetitionTrackingMiddleware)?0:Math.round(100*e.ipRepetitionTrackingMiddleware)/100}),(0,s.jsxs)("td",{className:"px-4 py-2 border relative name-h-color",children:[isNaN(e.averagePercentage)?0:Math.round(100*e.averagePercentage)/100,"%",(0,s.jsx)("div",{className:"w-full h-1 bg-gray-200 mt-1 relative overflow-hidden",children:(0,s.jsx)("div",{className:"h-full absolute left-0 top-0 transition-all duration-500\n                              ".concat(e.averagePercentage<50?"bg-red-500":"","\n                              ").concat(e.averagePercentage>=50&&e.averagePercentage<75?"bg-yellow-500":"","\n                              ").concat(e.averagePercentage>=75?"bg-green-500":""),style:{width:"".concat(isNaN(e.averagePercentage)?0:e.averagePercentage,"%")}})})]})]},e._id)})})]})}):(0,s.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No login events found."})}),(0,s.jsx)(u,{className:"flex justify-end mt-4",children:(0,s.jsx)("button",{onClick:o,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 focus:ring-2 focus:ring-blue-500",children:"Close"})})]})})};var N=a(1337),v=a(8617);let w=()=>{var e;let t=(0,l.jL)(),[a,o]=(0,r.useState)(!1),[n,i]=(0,r.useState)(null),[d,c]=(0,r.useState)(null),h=(0,l.GV)(e=>e.user);(0,r.useEffect)(()=>{t((0,N.nt)())},[t]);let x=async e=>{i(e),o(!0),t((0,b.s)(e))},p=e=>{c(e)};return(0,s.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[(0,s.jsx)("div",{className:"flex justify-start items-start mb-4",children:(0,s.jsx)("h1",{className:"assign-text ps-2 py-2",children:"Assign Carrier"})}),(0,s.jsxs)("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400 border border-[#F0F0F0] rounded-lg",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 bg-[#5FA7F5] text-white font-bold rounded-tl-lg risk",children:"Name"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 bg-[#5FA7F5] text-white font-bold risk",children:"Email ID"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 bg-[#5FA7F5] text-white font-bold risk",children:"Contact Number"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 bg-[#5FA7F5] text-white font-bold risk",children:"Country"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 bg-[#5FA7F5] text-white font-bold risk",children:"State"}),(0,s.jsxs)("th",{scope:"col",className:"px-6 py-3 bg-[#3a65ff] text-white font-bold text-center",children:[(0,s.jsx)("h1",{className:"risk",children:"Risk Score"}),(0,s.jsx)("h4",{className:"power-zt",children:"Powered by ZT Fortio"})]}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 bg-[#5FA7F5] text-white font-bold text-center rounded-tr-lg risk",children:"Action"})]})}),(0,s.jsx)("tbody",{children:Array.isArray(null==h?void 0:null===(e=h.userDetails)||void 0===e?void 0:e.userlisting)&&h.userDetails.userlisting.map((e,t)=>(0,s.jsxs)("tr",{className:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:[(0,s.jsxs)("td",{className:"px-6 py-2 name-h-color flex items-center justify-start mt-3 gap-2",children:[e.name,(0,s.jsx)(v.A,{className:"w-5 text-blue-500 cursor-pointer hover:text-blue-700",onClick:()=>p(e)})]}),(0,s.jsx)("td",{className:"px-6 py-2 name-h-color",children:e.email}),(0,s.jsx)("td",{className:"px-6 py-2 name-h-color",children:e.contactNumber}),(0,s.jsx)("td",{className:"px-6 py-2 name-h-color",children:e.country}),(0,s.jsx)("td",{className:"px-6 py-2 name-h-color",children:e.state}),(0,s.jsx)("td",{className:"px-6 py-2 name-h-color bg-[#3a65ff]",children:(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsxs)("span",{onClick:()=>x(e._id),className:"\n        inline-block border-2 p-2 rounded-lg text-center w-24 py-2 font-bold text-lg \n        ".concat(e.riskFactor<50?"border-red-500 text-red-500 bg-white":"","\n        ").concat(e.riskFactor>=50&&e.riskFactor<75?"border-yellow-500 text-yellow-500 bg-white":"","\n        ").concat(e.riskFactor>=75?"border-green-500 text-green-500 bg-white":"","\n      "),style:{borderWidth:"3px"},children:[Math.round(100*e.riskFactor)/100,"%"]})})}),(0,s.jsx)("td",{className:"px-6 py-2 cursor-pointer",children:(0,s.jsx)("button",{type:"button",className:"border-2 border-[#4785EA] bg-[#f5f8ff] text-black font-bold py-2 px-6 rounded-lg shadow-md hover:bg-[#e3eaff] transition",children:"Assign"})})]},t))})]}),a&&(0,s.jsx)(j,{isOpen:a,userId:n,onClose:()=>{o(!1),i(null)}}),d&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-1/3 relative ",children:[(0,s.jsxs)("div",{className:" border-gray-300 pb-4 relative",children:[(0,s.jsx)("button",{className:"absolute top-0 right-3 bg-blue-500 text-white rounded-full w-7 h-7 flex items-center justify-center hover:bg-blue-700",onClick:()=>{c(null)},children:"✖"}),(0,s.jsx)("h3",{className:"text-xl font-bold",children:d.name}),(0,s.jsx)("p",{className:"text-gray-700 leading-relaxed mt-2",children:d.description})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[(0,s.jsxs)("div",{className:"border rounded-lg p-4 shadow-md",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 flex items-center",children:"\uD83D\uDE9A Fleet"}),(0,s.jsx)("p",{className:"font-bold text-xl",children:d.fleetSize})]}),(0,s.jsxs)("div",{className:"border rounded-lg p-4 shadow-md",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 flex items-center",children:"\uD83D\uDCCD Location"}),(0,s.jsx)("p",{className:"font-bold text-xl",children:d.location})]})]}),(0,s.jsxs)("div",{className:"border rounded-lg p-4 shadow-md mt-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 flex items-center",children:"\uD83D\uDCE7 Driver Emails"}),(0,s.jsx)("div",{className:"font-bold text-blue-600 flex flex-wrap gap-2 mt-2",children:d.driver_email.map((e,t)=>(0,s.jsxs)("span",{className:"whitespace-nowrap",children:[e," ",t!==d.driver_email.length-1&&"|"]},t))})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[505,745,441,517,358],()=>t(2768)),_N_E=e.O()}]);